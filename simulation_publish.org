#+TITLE: Simulation Publish
#+OPTIONS: toc:nil num:nil ^:nil

This file is used to publish the simulation config documentation to =.html=
in the =doc/= directory.

* Project publish function
#+BEGIN_SRC emacs-lisp :results silent
  (unless (boundp 'org-publish-project-alist)
    (setq org-publish-project-alist nil))

  (let* ((this-dir (file-name-directory (or load-file-name buffer-file-name)))
         (org-export-html-style-default "")
         (org-export-htmlize-output-type 'css)
         (load-path (cons (expand-file-name "elpa" this-dir) load-path))
         (package-archives '(("original" . "http://tromey.com/elpa/"))))
    ;; load up htmlize
    (package-initialize)
    (let ((package 'htmlize))
      (unless (or (member package package-activated-list)
                  (functionp package))
        (package-install package)))
    (require 'htmlize)
    (org-html-htmlize-generate-css)
    ;; define the org-publish-project for the starter kit
    (add-to-list
     'org-publish-project-alist
     `("simulation-documentation"
       :base-directory ,this-dir
       :base-extension "org"
       :style "<link rel=\"stylesheet\" href=\"stylesheets/styles.css\">
               <link rel=\"stylesheet\" href=\"stylesheets/org-pygments.css\">"
       :publishing-directory ,(expand-file-name "doc" this-dir)
       :index-filename "starter-kit.org"
       :html-preamble "<span><a href=\"simulation_config.html\">main</a></span>
                       <span><a href=\"sngeometry_manager.html\">geometry manager</a></span>
                       <span><a href=\"sng4_manager.html\">G4 manager</a></span>
                       <span><a href=\"step_hit_processor_factory.html\">step hit processor</a></span>
                       <span><a href=\"sngenbb_manager.html\">genbb manager</a></span>
                       <span><a href=\"snanalysis_manager.html\">analysis</a></span>
                       "
       :html-postamble nil))
    ;; publish the starter kit
    (org-publish-project "simulation-documentation" 'force)
    ;; copy starter-kit.html to index.html
    (copy-file (expand-file-name "simulation_config.html" (expand-file-name "doc" this-dir))
               (expand-file-name "index.html" (expand-file-name "doc" this-dir)) t))
  #+END_SRC

* CSS stylesheets
:PROPERTIES:
:CUSTOM_ID: css_stylesheets
:END:
** Main stylesheets
:PROPERTIES:
:TANGLE: doc/stylesheets/styles.css
:END:
*** Google fonts
#+BEGIN_SRC css
  @import url(https://fonts.googleapis.com/css?family=Lato:300italic,700italic,300,700);
  @import url(https://fonts.googleapis.com/css?family=Inconsolata);
  @import url(https://fonts.googleapis.com/css?family=Lobster);
  @import url(https://fonts.googleapis.com/css?family=Cabin);
#+END_SRC

*** Other stuff
#+BEGIN_SRC css
  body {
      width:860px;
      margin:0 auto;
      padding:50px;
      font:14px/1.5 Lato, "Helvetica Neue", Helvetica, Arial, sans-serif;
      color:#777;
      font-weight:300;
  }

  h1, h2, h3, h4, h5, h6 {
      color:#222;
      margin:0 0 20px;
  }

  p, ul, ol, table, pre, dl {
      margin:0 0 20px;
  }

  h1, h2, h3 {
      line-height:1.1;
  }

  h1 {
      font-family:Lobster;
      font-size:48px;
  }

  h2 {
      color:#393939;
  }

  h3, h4, h5, h6 {
      color:#494949;
  }

  a {
      color:#39c;
      font-weight:400;
      text-decoration:none;
  }

  a:hover {
      color:#069;
  }

  a small {
      font-size:11px;
      color:#777;
      margin-top:-0.6em;
      display:block;
  }

  a:hover small {
      color:#777;
  }

  blockquote {
      border-left:1px solid #e5e5e5;
      margin:0;
      padding:0 0 0 20px;
      font-style:italic;
  }

  code, pre {
      font-family:Inconsolata, Monaco, Bitstream Vera Sans Mono, Lucida Console, Terminal;
      color:#333;
      font-size:12px;
  }

  pre {
      padding:8px 15px;
      background: #f8f8f8;
      border-radius:5px;
      border:1px solid #e5e5e5;
      overflow-x: auto;
  }

  table {
      width:100%;
      border-collapse:collapse;
  }

  th, td {
      text-align:left;
      padding:5px 10px;
      border-bottom:1px solid #e5e5e5;
  }

  dt {
      color:#444;
      font-weight:700;
  }

  th {
      color:#444;
  }

  img {
      max-width:100%;
  }

  header {
      width:270px;
      float:left;
      position:fixed;
  }

  header ul {
      list-style:none;
      height:40px;

      padding:0;

      background: #eee;
      background: -moz-linear-gradient(top, #f8f8f8 0%, #dddddd 100%);
      background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#f8f8f8), color-stop(100%,#dddddd));
      background: -webkit-linear-gradient(top, #f8f8f8 0%,#dddddd 100%);
      background: -o-linear-gradient(top, #f8f8f8 0%,#dddddd 100%);
      background: -ms-linear-gradient(top, #f8f8f8 0%,#dddddd 100%);
      background: linear-gradient(top, #f8f8f8 0%,#dddddd 100%);

      border-radius:5px;
      border:1px solid #d2d2d2;
      box-shadow:inset #fff 0 1px 0, inset rgba(0,0,0,0.03) 0 -1px 0;
      width:270px;
  }

  header li {
      width:89px;
      float:left;
      border-right:1px solid #d2d2d2;
      height:40px;
  }

  header li:first-child a {
      border-radius:5px 0 0 5px;
  }

  header li:last-child a {
      border-radius:0 5px 5px 0;
  }

  header ul a {
      line-height:1;
      font-size:11px;
      color:#999;
      display:block;
      text-align:center;
      padding-top:6px;
      height:34px;
  }

  header ul a:hover {
      color:#999;
      background: -moz-linear-gradient(top, #fff 0%, #ddd 100%);
      background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#fff), color-stop(100%,#ddd));
      background: -webkit-linear-gradient(top, #fff 0%,#ddd 100%);
      background: -o-linear-gradient(top, #fff 0%,#ddd 100%);
      background: -ms-linear-gradient(top, #fff 0%,#ddd 100%);
      background: linear-gradient(top, #fff 0%,#ddd 100%);
  }

  header ul a:active {
      -webkit-box-shadow: inset 0px 2px 2px 0px #ddd;
      -moz-box-shadow: inset 0px 2px 2px 0px #ddd;
      box-shadow: inset 0px 2px 2px 0px #ddd;
  }

  strong {
      color:#222;
      font-weight:700;
  }

  header ul li + li {
      width:88px;
      border-left:1px solid #fff;
  }

  header ul li + li + li {
      border-right:none;
      width:89px;
  }

  header ul a strong {
      font-size:14px;
      display:block;
      color:#222;
  }

  #content {
      width:700px;
      float:right;
      padding-bottom:50px;
      /* border:1px solid #e5e5e5; */
      /* border-width:1px 0; */
      /* padding:20px 0; */
      /* margin:0 0 20px; */
  }

  small {
      font-size:11px;
  }

  hr {
      border:0;
      background:#e5e5e5;
      height:1px;
      margin:0 0 20px;
  }

  footer {
      width:270px;
      float:left;
      position:fixed;
      bottom:50px;
  }

  #preamble {
      /* font-size:1.1em; */
      text-transform:uppercase;
      float:left;
      /* margin-left:-12em; */
      width:9em;
      text-align:right;
      position:fixed;
  }

  #preamble a {
      display:block;
      padding:0.2em 1em;
      color:#39c;
  }

  #preamble a:hover {
      background-color:#39c;
      text-decoration:none;
      color:#f9f9f9;
      -webkit-transition:color .2s linear;
  }

  @media print, screen and (max-width: 960px) {

      body {
          width:auto;
          margin:0;
      }

      header, content, footer {
          float:none;
          position:static;
          width:auto;
      }

      header {
          padding-right:320px;
      }

      header a small {
          display:inline;
      }

      header ul {
          position:absolute;
          right:50px;
          top:52px;
      }
  }

  @media print, screen and (max-width: 720px) {
      body {
          word-wrap:break-word;
      }

      header {
          padding:0;
      }

      header ul, header p.view {
          position:static;
      }

      pre, code {
          word-wrap:normal;
      }
  }

  @media print, screen and (max-width: 480px) {
      body {
          padding:15px;
      }

      header ul {
          display:none;
      }
  }

  @media print {
      body {
          padding:0.4in;
          font-size:12pt;
          color:#444;
      }
  }
#+END_SRC

** Org source code styles
:PROPERTIES:
:TANGLE: doc/stylesheets/org-pygments.css
:END:

#+BEGIN_SRC css
  .org-string,
  .org-type {
      color: #DEB542;
  }

  .org-builtin,
  .org-variable-name,
  .org-constant,
  .org-function-name {
      color: #69B7F0;
  }

  .org-comment,
  .org-comment-delimiter,
  .org-doc {
      color: #93a1a1;
  }

  .org-keyword {
      color: #D33682;
  }

  pre {
      color: #353535;
  }
#+END_SRC
